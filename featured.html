<head>
	<title>Got Features?</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href='http://fonts.googleapis.com/css?family=Kite%20One' rel='stylesheet' type='text/css'>
	<script>
		function redisplayDiffTimes() {
			$('span[data-time]').each(function (index, value) {
				this.innerText = formatDate(parseInt(value.getAttribute('data-time')));
			});
		}
		$(function () {
			window.setInterval(redisplayDiffTimes, 10000);
		});
	</script>
</head>

<body>
	{{> header }}
	<div class="container-fluid" style="padding-top: 1.5em">
		{{> controls }}
		<div class="well">
			{{> features }}
		</div>
	</div>
</body>

<template name="header">
<div class="well">
	<div class="pull-right">
		{{loginButtons}}
	</div>
</div>
</template>

<template name="feature-update">
</template>

<template name="controls">
	<h1>Got Features?</h1>
	{{#if currentUser}}
		<div class="form-horizontal">
			<label for="feature-name">New Feature Name</label>
			<input type="text" name="feature-name" />

			<button class="btn" name="feature-add">Add Feature</button>
		</div>
	{{/if}}
</template>

<template name="features">
{{#each features}}
	{{> feature}}
{{else}}
	No active features.
{{/each}}
</template>

<template name="feature">
<div class="feature" data-feature-id="{{_id}}">
	<div class="lead">
		{{name}}
	</div>
	{{#if currentUser}}
		<button class="btn dock-upper-right" name="close-feature">Close</button>
	{{else}}
		<img class="dock-upper-right" src="{{ getAuthorImage author }}" /><!--{{author.profile.name}}-->
	{{/if}}
	<div class="row-fluid">
		<span class="status">{{status this}}</span>
		<span class="muted pull-right">
			Created: <span data-time="{{timestamp}}">{{dateRender timestamp}}</span>
		</span>
	</div>

	<fieldset class="well">
		{{#if currentUser }}
		<!-- editable -->
		{{else}}
		<div>
		{{/if}}
		{{#items this}}
			{{#if currentUser }}
			<label class="checkbox">
				<input type="checkbox" name="{{ name }}" {{ checked name }} />
				{{ description }} 
			</label>
			{{else}}
			<div>
			{{#if checked }}
				<i class="icon-ok"></i>
				<span style="color:#88CC88">{{ description }}</span>
			{{else}}
				<i class="icon-remove"></i>
				<span style="color:#880000">{{ description }}</span>
			{{/if}}
			</div>
			{{/if}}
		{{/items}}
		{{#if currentUser }}
			<!-- end editable -->
		{{else}}
		</div>
		{{/if}}
	</fieldset>
</div>
</template>
